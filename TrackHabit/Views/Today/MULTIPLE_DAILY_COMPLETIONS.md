# 🔄 Множинні виконання звичок - Документація

## ✅ Виконані зміни

### 1. **Виправлено помилку дублювання extension**
- ❌ Видалено duplicate extension `View.if` з `HabitDetailView.swift` та `InsightsView.swift`
- ✅ Створено окремий файл `ViewExtensions.swift` для глобальних extensions

### 2. **Модель даних (Habit.swift)**

#### Нові властивості:
```swift
var dailyRepetitions: Int      // Кількість разів на день (1-5)
var reminderTimes: [Date]?      // Масив часів для нагадувань
```

#### Нові computed properties:
```swift
var todayCompletionCount: Int           // Скільки разів виконано сьогодні
var todayCompletionProgress: Double     // Прогрес (0.0-1.0)
var isCompletedToday: Bool              // Повністю виконано (всі рази)
```

### 3. **UI компоненти**

#### TodayView - HabitCard:
- ✅ Показує прогрес-дугу для множинних виконань
- ✅ Відображає текст "1/2", "2/3" і т.д.
- ✅ Галочка з'являється тільки коли все виконано
- ✅ Бейдж "2x/day" показує кількість виконань

**Візуалізація:**

**1x на день (стандарт):**
```
⚪ → ✅
Пусто → Галочка
```

**2x на день:**
```
⚪ → 🔵 (1/2) → ✅
Пусто → Половина дуги + текст → Повна дуга + галочка
```

**3x на день:**
```
⚪ → 🔵 (1/3) → 🔵 (2/3) → ✅
```

#### EditHabitView - Налаштування:
- ✅ Picker "Times per day" (1x-5x)
- ✅ Динамічні поля для нагадувань:
  - 1x = 1 DatePicker
  - 2x = 2 DatePickers (Reminder 1, Reminder 2)
  - 3x = 3 DatePickers і т.д.

### 4. **Логіка toggleHabit()**

**Для 1x на день (як раніше):**
- Toggle: не виконано ↔ виконано

**Для 2x+ на день:**
- Клік 1: додає 1 check-in (1/2)
- Клік 2: додає 2 check-in (2/2 = виконано ✅)
- Клік 3: видаляє останній check-in (назад до 1/2)

### 5. **Дефолтні часи нагадувань**

Коли встановлюється `dailyRepetitions > 1`, автоматично створюються дефолтні часи:
- 1й раз: 9:00
- 2й раз: 14:00
- 3й раз: 20:00
- 4й раз: 12:00
- 5й раз: 16:00

## 🎯 Приклади використання

### Чистка зубів (2x на день):
- **Ранок:** 8:00 ✅
- **Вечір:** 21:00 ✅

### Пити воду (3x на день):
- **Ранок:** 9:00
- **Обід:** 14:00
- **Вечір:** 20:00

### Тренування (1x на день):
- **Стандарт:** 18:00

## 📱 Візуальний досвід

### Список звичок (TodayView):
```
┌─────────────────────────────────┐
│ 🦷 Чистка зубів      [1/2] 🔵  │
│    🔥 5  •  2x/day              │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 💧 Пити воду         [3/3] ✅  │
│    🔥 12  •  3x/day             │
└─────────────────────────────────┘
```

### Редагування звички:
```
┌─────────────────────────────────┐
│ 🔁 Times per day    [  2x  ▼]  │
│    Скільки разів виконувати     │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 🔔 Daily Reminder    [ON]       │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 🕐 Reminder 1        [ 8:00 ]   │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 🕐 Reminder 2        [ 21:00 ]  │
└─────────────────────────────────┘
```

## 🔮 Майбутні покращення

1. **Віджети** - показувати прогрес у віджетах
2. **Статистика** - враховувати множинні виконання в графіках
3. **Goals** - налаштування цілей з урахуванням repetitions
4. **History** - показувати всі check-ins за день

## ⚠️ Важливо

- Існуючі звички автоматично мають `dailyRepetitions = 1`
- Старі check-ins залишаються без змін
- Нагадування працюють незалежно для кожного часу
